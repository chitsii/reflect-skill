---
description: タスクに関連する知識を検索して抽出
---

# /reflect-skill:search

Task tool (Explore) を使用して `.reflect/knowledge/` から関連知識を検索・抽出する。

## 用途

- 実装・修正タスクを受けた時に、関連する知識を事前に取得
- 親セッションのコンテキストを汚さずに必要な知識だけを渡す

## 起動条件

以下に該当するタスクを受けた時に実行を推奨:

| 条件 | 例 |
|------|-----|
| コード実装を伴う | 「〜を作って」「〜を実装して」 |
| 修正・変更を伴う | 「〜を直して」「〜を変えて」 |
| 設計判断を伴う | 「〜をどう実装すべき？」 |

**除外**: 質問のみ、情報提供、レビュー依頼、git操作のみ

## 実行方法

Task tool を以下の設定で起動:

```
Task tool:
  subagent_type: "Explore"
  model: "haiku"           # 高速・低コスト（推奨）
  description: "知識ベース検索"
  prompt: |
    .reflect/knowledge/ を検索し、タスクに関連する知識を抽出してください。

    ## タスク内容
    {{ここにタスクを記載}}

    ## 検索手順
    1. `.reflect/knowledge/high/` の全ファイルを読む（常に必要）
    2. `.reflect/knowledge/medium/_index.md` を読む
    3. タスク内容と _index.md のキーワードを照合
    4. マッチしたファイルがあれば読む
    5. タスクに直接関連する部分のみ抽出

    ## 出力形式

    📚 関連知識 (N件)

    [High] {{カテゴリ}}
    - {{箇条書きで要点のみ}}
    - {{箇条書きで要点のみ}}

    [Medium] {{カテゴリ}}
    - {{箇条書きで要点のみ}}

    ---
    関連知識なし の場合は「該当なし」と報告
```

## 検索ロジック

### キーワードマッチング

`_index.md` の形式:
```markdown
# Index

## ui.md
**トリガ**: Button, ボタン, コンポーネント, UI, shadcn, Tailwind
**概要**: UIコンポーネントの規約

## naming.md
**トリガ**: 命名, naming, 変数名, 関数名, camelCase
**概要**: 命名規則
```

### マッチ判定

| タスクに含まれる語 | マッチ対象 |
|-------------------|-----------|
| 「ボタン」「Button」「UI」 | ui.md |
| 「変数」「関数名」「命名」 | naming.md |
| 「API」「fetch」「通信」 | api.md |

### 関連性の判断基準

1. **直接マッチ**: タスク内のキーワードが _index.md のトリガに含まれる
2. **類義語マッチ**: 同義の日本語/英語がトリガに含まれる
3. **文脈マッチ**: タスクの目的から推測される関連カテゴリ

## 返却内容

親セッションに渡す情報:

```markdown
📚 関連知識 (2件)

[High] UI規約
- Button は shadcn から使用
- 独自スタイル禁止

[Medium] 命名規則
- camelCase 使用
- 略語禁止（×usr ○user）

---
出典: .reflect/knowledge/high/main.md, medium/naming.md
```

## 注意

- 知識ファイル全文ではなく、**タスクに関連する部分のみ**を抽出
- 200行を超える知識は要約して渡す
- 関連知識がない場合は「該当なし」と明示
